function bp_init_activity(){jq.cookie("bp-activity-oldestpage",1,{path:"/"}),null!=jq.cookie("bp-activity-filter")&&jq("#activity-filter-select").length&&jq('#activity-filter-select select option[value="'+jq.cookie("bp-activity-filter")+'"]').prop("selected",!0),null!=jq.cookie("bp-activity-scope")&&jq(".activity-type-tabs").length&&(jq(".activity-type-tabs li").each(function(){jq(this).removeClass("selected")}),jq("li#activity-"+jq.cookie("bp-activity-scope")+", .item-list-tabs li.current").addClass("selected"))}function bp_init_objects(e){jq(e).each(function(t){null!=jq.cookie("bp-"+e[t]+"-filter")&&jq("li#"+e[t]+"-order-select select").length&&jq("li#"+e[t]+'-order-select select option[value="'+jq.cookie("bp-"+e[t]+"-filter")+'"]').prop("selected",!0),null!=jq.cookie("bp-"+e[t]+"-scope")&&jq("div."+e[t]).length&&(jq(".item-list-tabs li").each(function(){jq(this).removeClass("selecteds")}),jq(".item-list-tabs li#"+e[t]+"-"+jq.cookie("bp-"+e[t]+"-scope")+", div.item-list-tabs#object-nav li.current").addClass("selected"))})}function bp_filter_request(e,t,i,a,s,n,r,o){return"activity"==e?!1:(bp_get_querystring("s")&&!s&&(s=bp_get_querystring("s")),null==i&&(i="all"),jq.cookie("bp-"+e+"-scope",i,{path:"/"}),jq.cookie("bp-"+e+"-filter",t,{path:"/"}),jq.cookie("bp-"+e+"-extras",r,{path:"/"}),jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected")}),jq(".item-list-tabs li#"+e+"-"+i+", .item-list-tabs#object-nav li.current").addClass("selected"),jq(".item-list-tabs li.selected").addClass("loading"),jq('.item-list-tabs select option[value="'+t+'"]').prop("selected",!0),"friends"==e&&(e="members"),bp_ajax_request&&bp_ajax_request.abort(),void(bp_ajax_request=jq.post(ajaxurl,{action:e+"_filter",cookie:bp_get_cookies(),object:e,filter:t,search_terms:s,scope:i,page:n,extras:r},function(e){if("pag-bottom"==o&&jq("#subnav").length){var t=jq("#subnav").parent();jq("html,body").animate({scrollTop:t.offset().top},"slow",function(){jq(a).fadeOut(100,function(){jq(this).html(e),jq(this).fadeIn(100)})})}else jq(a).fadeOut(100,function(){jq(this).html(e),jq(this).fadeIn(100)});jq(".item-list-tabs li.selected").removeClass("loading")})))}function bp_activity_request(e,t){jq.cookie("bp-activity-scope",e,{path:"/"}),jq.cookie("bp-activity-filter",t,{path:"/"}),jq.cookie("bp-activity-oldestpage",1,{path:"/"}),jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected active loading")}),jq("li#activity-"+e+", .item-list-tabs li.current").addClass("selected active"),jq("#object-nav.item-list-tabs li.selected, div.activity-type-tabs li.selected").addClass("loading"),jq('#activity-filter-select select option[value="'+t+'"]').prop("selected active",!0),jq(".widget_bp_activity_widget h2 span.ajax-loader").show(),bp_ajax_request&&bp_ajax_request.abort(),bp_ajax_request=jq.post(ajaxurl,{action:"activity_widget_filter",cookie:bp_get_cookies(),_wpnonce_activity_filter:jq("input#_wpnonce_activity_filter").val(),scope:e,filter:t},function(e){jq(".widget_bp_activity_widget h2 span.ajax-loader").hide(),jq("div.activity").fadeOut(100,function(){jq(this).html(e.contents),jq(this).fadeIn(100),bp_dtheme_hide_comments()}),null!=e.feed_url&&jq(".directory #subnav li.feed a, .home-page #subnav li.feed a").attr("href",e.feed_url),jq(".item-list-tabs li.selected").removeClass("loading")},"json")}function bp_dtheme_hide_comments(){var e=jq("div.activity-comments");return e.length?void e.each(function(){if(!(jq(this).children("ul").children("li").length<5)){var e=jq(this),t=e.parents("ul#activity-stream > li"),i=jq(this).children("ul").children("li"),a=" ";if(jq("li#"+t.attr("id")+" a.acomment-reply span").length)var a=jq("li#"+t.attr("id")+" a.acomment-reply span").html();i.each(function(e){e<i.length-5&&(jq(this).addClass("hidden"),jq(this).toggle(),e||jq(this).before('<li class="show-all"><a href="#'+t.attr("id")+'/show-all/" title="'+BP_DTheme.show_all_comments+'">'+BP_DTheme.show_x_comments.replace("%d",a)+"</a></li>"))})}}):!1}function checkAll(){for(var e=document.getElementsByTagName("input"),t=0;t<e.length;t++)"checkbox"==e[t].type&&(""==$("check_all").checked?e[t].checked="":e[t].checked="checked")}function clear(e){if(document.getElementById(e)){var e=document.getElementById(e);if(radioButtons=e.getElementsByTagName("INPUT"))for(var t=0;t<radioButtons.length;t++)radioButtons[t].checked="";if(options=e.getElementsByTagName("OPTION"))for(var t=0;t<options.length;t++)options[t].selected=!1}}function bp_get_cookies(){for(var e=document.cookie.split(";"),t={},i="bp-",a=0;a<e.length;a++){var s=e[a],n=s.indexOf("="),r=jq.trim(unescape(s.slice(0,n))),o=unescape(s.slice(n+1));0==r.indexOf(i)&&(t[r]=o)}return encodeURIComponent(jq.param(t))}var jq=jQuery,bp_ajax_request=null;jq(document).ready(function(){"-1"==window.location.search.indexOf("new")&&jq("div.forums").length?jq("#new-topic-post").hide():jq("#new-topic-post").show(),bp_init_activity();var e=["members","groups","blogs","forums"],t=jq("#whats-new");if(bp_init_objects(e),t.length&&bp_get_querystring("r")){var i=t.val();jq("#whats-new-options").animate({height:"60px"}),t.animate({height:"50px"}),jq.scrollTo(t,500,{offset:-125,easing:"swing"}),t.val("").focus().val(i)}jq("#whats-new").focus(function(){jq("#whats-new-options").animate({height:"60px"}),jq("form#whats-new-form textarea").animate({height:"70px"}),jq("#aw-whats-new-submit").prop("disabled",!1);var e=jq("form#whats-new-form");e.hasClass("submitted")&&e.removeClass("submitted")}),jq("#whats-new").blur(function(){this.value.match(/\S+/)||(this.value="",jq("#whats-new-options").animate({height:"60px"}),jq("form#whats-new-form textarea").animate({height:"20px"}),jq("#aw-whats-new-submit").prop("disabled",!0))}),jq("input#aw-whats-new-submit").click(function(){var e=jq(this),t=e.closest("form#whats-new-form");t.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!0)}),jq("div.error").remove(),e.addClass("loading"),e.prop("disabled",!0),t.addClass("submitted");var i="",a=jq("#whats-new-post-in").val(),s=jq("textarea#whats-new").val();return a>0&&(i=jq("#whats-new-post-object").val()),jq.post(ajaxurl,{action:"post_update",cookie:bp_get_cookies(),_wpnonce_post_update:jq("input#_wpnonce_post_update").val(),content:s,object:i,item_id:a,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},function(e){if(t.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!1)}),e[0]+e[1]=="-1")t.prepend(e.substr(2,e.length)),jq("form#"+t.attr("id")+" div.error").hide().fadeIn(200);else{if(0==jq("ul.activity-list").length&&(jq("div.error").slideUp(100).remove(),jq("div#message").slideUp(100).remove(),jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),jq("ul#activity-stream").prepend(e),jq("ul#activity-stream li:first").addClass("new-update just-posted"),0!=jq("#latest-update").length){var i=jq("ul#activity-stream li.new-update .activity-content .activity-inner p").html(),a=jq("ul#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),s=jq("ul#activity-stream li.new-update .activity-content .activity-inner p").text(),n="";""!=s&&(n=i+" "),n+='<a href="'+a+'" rel="nofollow">'+BP_DTheme.view+"</a>",jq("#latest-update").slideUp(300,function(){jq("#latest-update").html(n),jq("#latest-update").slideDown(300)})}jq("li.new-update").hide().slideDown(300),jq("li.new-update").removeClass("new-update"),jq("textarea#whats-new").val("")}jq("#whats-new-options").animate({height:"0px"}),jq("form#whats-new-form textarea").animate({height:"20px"}),jq("#aw-whats-new-submit").prop("disabled",!0).removeClass("loading")}),!1}),jq("div.activity-type-tabs").click(function(e){var t=jq(e.target).parent();if("STRONG"==e.target.nodeName||"SPAN"==e.target.nodeName)t=t.parent();else if("A"!=e.target.nodeName)return!1;jq.cookie("bp-activity-oldestpage",1,{path:"/"});var i=t.attr("id").substr(9,t.attr("id").length),a=jq("#activity-filter-select select").val();return"mentions"==i&&jq("li#"+t.attr("id")+" a strong").remove(),bp_activity_request(i,a),!1}),jq("#activity-filter-select select").change(function(){var e=jq("div.activity-type-tabs li.selected");if(e.length)var t=e.attr("id").substr(9,e.attr("id").length);else var t=null;var i=jq(this).val();return bp_activity_request(t,i),!1}),jq("div.activity").click(function(e){var t=jq(e.target);if(t.hasClass("fav")||t.hasClass("unfav")){var i=t.hasClass("fav")?"fav":"unfav",a=t.closest(".activity-item"),s=a.attr("id").substr(9,a.attr("id").length);return t.addClass("loading"),jq.post(ajaxurl,{action:"activity_mark_"+i,cookie:bp_get_cookies(),id:s},function(e){t.removeClass("loading"),t.fadeOut(100,function(){jq(this).html(e),jq(this).attr("title","fav"==i?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav),jq(this).fadeIn(100)}),"fav"==i?(jq(".item-list-tabs li#activity-favorites").length||jq(".item-list-tabs ul li#activity-mentions").before('<li id="activity-favorites"><a href="#">'+BP_DTheme.my_favs+" <span>0</span></a></li>"),t.removeClass("fav"),t.addClass("unfav"),jq(".item-list-tabs ul li#activity-favorites span").html(Number(jq(".item-list-tabs ul li#activity-favorites span").html())+1)):(t.removeClass("unfav"),t.addClass("fav"),jq(".item-list-tabs ul li#activity-favorites span").html(Number(jq(".item-list-tabs ul li#activity-favorites span").html())-1),Number(jq(".item-list-tabs ul li#activity-favorites span").html())||(jq(".item-list-tabs ul li#activity-favorites").hasClass("selected")&&bp_activity_request(null,null),jq(".item-list-tabs ul li#activity-favorites").remove())),"activity-favorites"==jq(".item-list-tabs li.selected").attr("id")&&t.parent().parent().parent().slideUp(100)}),!1}if(t.hasClass("delete-activity")){var n=t.parents("div.activity ul li"),r=n.attr("id").substr(9,n.attr("id").length),o=t.attr("href"),l=o.split("_wpnonce=");return l=l[1],t.addClass("loading"),jq.post(ajaxurl,{action:"delete_activity",cookie:bp_get_cookies(),id:r,_wpnonce:l},function(e){e[0]+e[1]=="-1"?(n.prepend(e.substr(2,e.length)),n.children("div#message").hide().fadeIn(300)):n.slideUp(300)}),!1}if(t.hasClass("spam-activity")){var n=t.parents("div.activity ul li");return t.addClass("loading"),jq.post(ajaxurl,{action:"bp_spam_activity",cookie:encodeURIComponent(document.cookie),id:n.attr("id").substr(9,n.attr("id").length),_wpnonce:t.attr("href").split("_wpnonce=")[1]},function(e){e[0]+e[1]==="-1"?(n.prepend(e.substr(2,e.length)),n.children("div#message").hide().fadeIn(300)):n.slideUp(300)}),!1}if(t.parent().hasClass("load-more")){jq("#content li.load-more").addClass("loading"),null==jq.cookie("bp-activity-oldestpage")&&jq.cookie("bp-activity-oldestpage",1,{path:"/"});var c=1*jq.cookie("bp-activity-oldestpage")+1,d=[];return jq(".activity-list li.just-posted").each(function(){d.push(jq(this).attr("id").replace("activity-",""))}),jq.post(ajaxurl,{action:"activity_get_older_updates",cookie:bp_get_cookies(),page:c,exclude_just_posted:d.join(",")},function(e){jq("#content li.load-more").removeClass("loading"),jq.cookie("bp-activity-oldestpage",c,{path:"/"}),jq("#content ul.activity-list").append(e.contents),t.parent().hide()},"json"),!1}}),jq("div.activity").on("click",".activity-read-more a",function(e){var t=jq(e.target),i=t.parent().attr("id").split("-"),a=i[3],s=i[0],n="acomment"==s?"acomment-content":"activity-inner",r=jq("li#"+s+"-"+a+" ."+n+":first");return jq(t).addClass("loading"),jq.post(ajaxurl,{action:"get_single_activity_content",activity_id:a},function(e){jq(r).slideUp(300).html(e).slideDown(300)}),!1}),jq("form.ac-form").hide(),jq(".activity-comments").length&&bp_dtheme_hide_comments(),jq("div.activity").click(function(e){var t=jq(e.target);if(t.hasClass("acomment-reply")||t.parent().hasClass("acomment-reply")){t.parent().hasClass("acomment-reply")&&(t=t.parent());var i=t.attr("id");ids=i.split("-");var a=ids[2],s=t.attr("href").substr(10,t.attr("href").length),n=jq("#ac-form-"+a);return n.css("display","none"),n.removeClass("root"),jq(".ac-form").hide(),n.children("div").each(function(){jq(this).hasClass("error")&&jq(this).hide()}),"comment"!=ids[1]?jq(".activity-comments li#acomment-"+s).append(n):jq("li#activity-"+a+" .activity-comments").append(n),n.parent().hasClass("activity-comments")&&n.addClass("root"),n.slideDown(200),jq.scrollTo(n,500,{offset:-100,easing:"swing"}),jq("#ac-form-"+ids[2]+" textarea").focus(),!1}if("ac_form_submit"==t.attr("name")){var n=t.parents("form"),r=n.parent(),o=n.attr("id").split("-");if(r.hasClass("activity-comments"))var l=o[2];else var c=r.attr("id").split("-"),l=c[1];jq("form#"+n.attr("id")+" div.error").hide(),t.addClass("loading").prop("disabled",!0);var d={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:jq("input#_wpnonce_new_activity_comment").val(),comment_id:l,form_id:o[2],content:jq("form#"+n.attr("id")+" textarea").val()},p=jq("#_bp_as_nonce_"+l).val();return p&&(d["_bp_as_nonce_"+l]=p),jq.post(ajaxurl,d,function(e){if(t.removeClass("loading"),e[0]+e[1]=="-1")n.append(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var i=n.parent();n.fadeOut(200,function(){0==i.children("ul").length&&(i.hasClass("activity-comments")?i.prepend("<ul></ul>"):i.append("<ul></ul>"));var t=jq.trim(e);i.children("ul").append(jq(t).hide().fadeIn(200)),n.children("textarea").val(""),i.parent().addClass("has-comments")}),jq("form#"+n.attr("id")+" textarea").val(""),jq("li#activity-"+o[2]+" a.acomment-reply span").html(Number(jq("li#activity-"+o[2]+" a.acomment-reply span").html())+1);var a=i.find(".show-all").find("a");if(a){var s=jq("li#activity-"+o[2]+" a.acomment-reply span").html();a.html(BP_DTheme.show_x_comments.replace("%d",s))}}jq(t).prop("disabled",!1)}),!1}if(t.hasClass("acomment-delete")){var j=t.attr("href"),u=t.parent().parent(),n=u.parents("div.activity-comments").children("form"),h=j.split("_wpnonce=");h=h[1];var l=j.split("cid=");return l=l[1].split("&"),l=l[0],t.addClass("loading"),jq(".activity-comments ul .error").remove(),u.parents(".activity-comments").append(n),jq.post(ajaxurl,{action:"delete_activity_comment",cookie:bp_get_cookies(),_wpnonce:h,id:l},function(e){if(e[0]+e[1]=="-1")u.prepend(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var t=jq("li#"+u.attr("id")+" ul").children("li"),i=0;jq(t).each(function(){jq(this).is(":hidden")||i++}),u.fadeOut(200,function(){u.remove()});var a=jq("li#"+u.parents("ul#activity-stream > li").attr("id")+" a.acomment-reply span"),s=a.html()-(1+i);a.html(s);var n=u.siblings(".show-all").find("a");n&&n.html(BP_DTheme.show_x_comments.replace("%d",s)),0==s&&jq(u.parents("ul#activity-stream > li")).removeClass("has-comments")}}),!1}if(t.hasClass("spam-activity-comment")){var j=t.attr("href"),u=t.parent().parent();return t.addClass("loading"),jq(".activity-comments ul div.error").remove(),u.parents(".activity-comments").append(u.parents(".activity-comments").children("form")),jq.post(ajaxurl,{action:"bp_spam_activity_comment",cookie:encodeURIComponent(document.cookie),_wpnonce:j.split("_wpnonce=")[1],id:j.split("cid=")[1].split("&")[0]},function(e){if(e[0]+e[1]=="-1")u.prepend(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var t=jq("li#"+u.attr("id")+" ul").children("li"),i=0;jq(t).each(function(){jq(this).is(":hidden")||i++}),u.fadeOut(200);var a=u.parents("ul#activity-stream > li");jq("li#"+a.attr("id")+" a.acomment-reply span").html(jq("li#"+a.attr("id")+" a.acomment-reply span").html()-(1+i))}}),!1}return t.parent().hasClass("show-all")?(t.parent().addClass("loading"),setTimeout(function(){t.parent().parent().children("li").fadeIn(200,function(){t.parent().remove()})},600),!1):void 0}),jq(document).keydown(function(e){if(e=e||window.event,e.target?element=e.target:e.srcElement&&(element=e.srcElement),3==element.nodeType&&(element=element.parentNode),1!=e.ctrlKey&&1!=e.altKey&&1!=e.metaKey){var t=e.keyCode?e.keyCode:e.which;27==t&&"TEXTAREA"==element.tagName&&jq(element).hasClass("ac-input")&&jq(element).parent().parent().parent().slideUp(200)}}),jq(".dir-search").click(function(e){if(!jq(this).hasClass("no-ajax")){var t=jq(e.target);if("submit"==t.attr("type")){var i=jq(".item-list-tabs li.selected").attr("id").split("-"),a=i[0];return bp_filter_request(a,jq.cookie("bp-"+a+"-filter"),jq.cookie("bp-"+a+"-scope"),"div."+a,t.parent().children("label").children("input").val(),1,jq.cookie("bp-"+a+"-extras")),!1}}}),jq("div.item-list-tabs").click(function(e){if(!jq(this).hasClass("no-ajax")){var t="SPAN"==e.target.nodeName?e.target.parentNode:e.target,i=jq(t).parent();if("LI"==i[0].nodeName&&!i.hasClass("last")){var a=i.attr("id").split("-"),s=a[0];if("activity"==s)return!1;var n=a[1],r=jq("#"+s+"-order-select select").val(),o=jq("#"+s+"_search").val();return bp_filter_request(s,r,n,"div."+s,o,1,jq.cookie("bp-"+s+"-extras")),!1}}}),jq("li.filter select").change(function(){if(jq(".item-list-tabs li.selected").length)var e=jq(".item-list-tabs li.selected");else var e=jq(this);var t=e.attr("id").split("-"),i=t[0],a=t[1],s=jq(this).val(),n=!1;return jq(".dir-search input").length&&(n=jq(".dir-search input").val()),"friends"==i&&(i="members"),bp_filter_request(i,s,a,"div."+i,n,1,jq.cookie("bp-"+i+"-extras")),!1}),jq("div#content").click(function(e){var t=jq(e.target);if(t.hasClass("button"))return!0;if(t.parent().parent().hasClass("pagination")&&!t.parent().parent().hasClass("no-ajax")){if(t.hasClass("dots")||t.hasClass("current"))return!1;if(jq(".item-list-tabs li.selected").length)var i=jq(".item-list-tabs li.selected");else var i=jq("li.filter select");var a=1,s=i.attr("id").split("-"),n=s[0],r=!1,o=jq(t).closest(".pagination-links").attr("id");if(jq("div.dir-search input").length&&(r=jq(".dir-search input").val()),jq(t).hasClass("next"))var a=Number(jq(".pagination span.current").html())+1;else if(jq(t).hasClass("prev"))var a=Number(jq(".pagination span.current").html())-1;else var a=Number(jq(t).html());if(-1!==o.indexOf("pag-bottom"))var l="pag-bottom";else var l=null;return bp_filter_request(n,jq.cookie("bp-"+n+"-filter"),jq.cookie("bp-"+n+"-scope"),"div."+n,r,a,jq.cookie("bp-"+n+"-extras"),l),!1}}),jq("a.show-hide-new").click(function(){return jq("#new-topic-post").length?(jq("#new-topic-post").is(":visible")?jq("#new-topic-post").slideUp(200):jq("#new-topic-post").slideDown(200,function(){jq("#topic_title").focus()}),!1):!1}),jq("input#submit_topic_cancel").click(function(){return jq("#new-topic-post").length?(jq("#new-topic-post").slideUp(200),!1):!1}),jq("#forum-directory-tags a").click(function(){return bp_filter_request("forums","tags",jq.cookie("bp-forums-scope"),"div.forums",jq(this).html().replace(/&nbsp;/g,"-"),1,jq.cookie("bp-forums-extras")),!1}),jq("div#invite-list input").click(function(){jq(".ajax-loader").toggle();var e=jq(this).val();if(1==jq(this).prop("checked"))var t="invite";else var t="uninvite";jq(".item-list-tabs li.selected").addClass("loading"),jq.post(ajaxurl,{action:"groups_invite_user",friend_action:t,cookie:bp_get_cookies(),_wpnonce:jq("input#_wpnonce_invite_uninvite_user").val(),friend_id:e,group_id:jq("input#group_id").val()},function(i){jq("#message")&&jq("#message").hide(),jq(".ajax-loader").toggle(),"invite"==t?jq("#friend-list").append(i):"uninvite"==t&&jq("#friend-list li#uid-"+e).remove(),jq(".item-list-tabs li.selected").removeClass("loading")})}),jq("#friend-list").on("click","li a.remove",function(){jq(".ajax-loader").toggle();var e=jq(this).attr("id");return e=e.split("-"),e=e[1],jq.post(ajaxurl,{action:"groups_invite_user",friend_action:"uninvite",cookie:bp_get_cookies(),_wpnonce:jq("input#_wpnonce_invite_uninvite_user").val(),friend_id:e,group_id:jq("input#group_id").val()},function(t){jq(".ajax-loader").toggle(),jq("#friend-list li#uid-"+e).remove(),jq("#invite-list input#f-"+e).prop("checked",!1)}),!1}),jq(".field-visibility-settings").hide(),jq(".visibility-toggle-link").on("click",function(e){e.preventDefault(),jq(this).parent().hide().addClass("field-visibility-settings-hide").siblings(".field-visibility-settings").show().addClass("field-visibility-settings-open")}),jq(".field-visibility-settings-close").on("click",function(e){e.preventDefault();var t=jq(this).parent(),i=t.find("input:checked").parent().text();t.hide().removeClass("field-visibility-settings-open").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(i).end().show().removeClass("field-visibility-settings-hide")}),jq("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var e=!0;jq("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){e=!1}),window.onbeforeunload=function(t){return e?BP_DTheme.unsaved_changes:void 0}}),jq("ul#friend-list a.accept, ul#friend-list a.reject").click(function(){var e=jq(this),t=jq(this).parents("ul#friend-list li"),i=jq(this).parents("li div.action"),a=t.attr("id").substr(11,t.attr("id").length),s=e.attr("href"),n=s.split("_wpnonce=");if(n=n[1],jq(this).hasClass("accepted")||jq(this).hasClass("rejected"))return!1;if(jq(this).hasClass("accept")){var r="accept_friendship";i.children("a.reject").css("visibility","hidden")}else{var r="reject_friendship";i.children("a.accept").css("visibility","hidden")}return e.addClass("loading"),jq.post(ajaxurl,{action:r,cookie:bp_get_cookies(),id:a,_wpnonce:n},function(a){e.removeClass("loading"),a[0]+a[1]=="-1"?(t.prepend(a.substr(2,a.length)),t.children("div#message").hide().fadeIn(200)):e.fadeOut(100,function(){jq(this).hasClass("accept")?(i.children("a.reject").hide(),jq(this).html(BP_DTheme.accepted).contents().unwrap()):(i.children("a.accept").hide(),jq(this).html(BP_DTheme.rejected).contents().unwrap())})}),!1}),jq("#members-dir-list").on("click",".friendship-button a",function(){jq(this).parent().addClass("loading");var e=jq(this).attr("id");e=e.split("-"),e=e[1];var t=jq(this).attr("href");t=t.split("?_wpnonce="),t=t[1].split("&"),t=t[0];var i=jq(this);return jq.post(ajaxurl,{action:"addremove_friend",cookie:bp_get_cookies(),fid:e,_wpnonce:t},function(e){var t=i.attr("rel"),a=i.parent();"add"==t?jq(a).fadeOut(200,function(){a.removeClass("add_friend"),a.removeClass("loading"),a.addClass("pending_friend"),a.fadeIn(200).html(e)}):"remove"==t&&jq(a).fadeOut(200,function(){a.removeClass("remove_friend"),a.removeClass("loading"),a.addClass("add"),a.fadeIn(200).html(e)})}),!1}),jq("#groups-dir-list").on("click",".group-button a",function(){var e=jq(this).parent().attr("id");e=e.split("-"),e=e[1];var t=jq(this).attr("href");t=t.split("?_wpnonce="),t=t[1].split("&"),t=t[0];var i=jq(this);return jq.post(ajaxurl,{action:"joinleave_group",cookie:bp_get_cookies(),gid:e,_wpnonce:t},function(e){var t=i.parent();jq("body.directory").length?jq(t).fadeOut(200,function(){t.fadeIn(200).html(e);var a=jq("#groups-personal span"),s=1;i.hasClass("leave-group")?(t.hasClass("hidden")&&t.closest("li").slideUp(200),s=0):i.hasClass("request-membership")&&(s=!1),s!==!1&&a.length&&(s?a.text((a.text()>>0)+1):a.text((a.text()>>0)-1))}):location.href=location.href}),!1}),jq(".pending").click(function(){return!1}),jq(".message-search").click(function(e){if(!jq(this).hasClass("no-ajax")){var t=jq(e.target);if("submit"==t.attr("type")){var i="messages";return bp_filter_request(i,jq.cookie("bp-"+i+"-filter"),jq.cookie("bp-"+i+"-scope"),"div."+i,t.parent().children("label").children("input").val(),1,jq.cookie("bp-"+i+"-extras")),!1}}}),jq("input#send_reply_button").click(function(){var e=jq("#messages_order").val()||"ASC",t=jq("#message-recipients").offset(),i=jq("input#send_reply_button");return jq(i).addClass("loading"),jq.post(ajaxurl,{action:"messages_send_reply",cookie:bp_get_cookies(),_wpnonce:jq("input#send_message_nonce").val(),content:jq("#message_content").val(),send_to:jq("input#send_to").val(),subject:jq("input#subject").val(),thread_id:jq("input#thread_id").val()},function(a){a[0]+a[1]=="-1"?jq("form#send-reply").prepend(a.substr(2,a.length)):(jq("form#send-reply div#message").remove(),jq("#message_content").val(""),"ASC"==e?jq("form#send-reply").before(a):(jq("#message-recipients").after(a),jq(window).scrollTop(t.top)),jq(".new-message").hide().slideDown(200,function(){jq(".new-message").removeClass("new-message")})),jq(i).removeClass("loading")}),!1}),jq("a#mark_as_read, a#mark_as_unread").click(function(){var e="",t=jq("#message-threads tr td input[type='checkbox']");if("mark_as_unread"==jq(this).attr("id"))var i="read",a="unread",s=1,n=0,r="inline",o="messages_markunread";else var i="unread",a="read",s=0,n=1,r="none",o="messages_markread";return t.each(function(n){if(jq(this).is(":checked")&&jq("tr#m-"+jq(this).attr("value")).hasClass(i)){e+=jq(this).attr("value"),jq("tr#m-"+jq(this).attr("value")).removeClass(i),jq("tr#m-"+jq(this).attr("value")).addClass(a);var o=jq("tr#m-"+jq(this).attr("value")+" td span.unread-count").html();jq("tr#m-"+jq(this).attr("value")+" td span.unread-count").html(s),jq("tr#m-"+jq(this).attr("value")+" td span.unread-count").css("display",r);var l=jq("tr.unread").length;jq("a#user-messages span").html(l),n!=t.length-1&&(e+=",")}}),jq.post(ajaxurl,{action:o,thread_ids:e}),!1}),jq("body.messages #item-body div.messages").on("change","#message-type-select",function(){var e=this.value,t=jq("td input[type='checkbox']");t.each(function(e){t[e].checked=""});var i="checked";switch(e){case"unread":t=jq("tr.unread td input[type='checkbox']");break;case"read":t=jq("tr.read td input[type='checkbox']");break;case"":i=""}t.each(function(e){t[e].checked=i})}),jq("body.messages #item-body div.messages").on("click",".messages-options-nav a",function(){return-1!=jq.inArray(this.id,Array("delete_sentbox_messages","delete_inbox_messages"))?(checkboxes_tosend="",checkboxes=jq("#message-threads tr td input[type='checkbox']"),jq("#message").remove(),jq(this).addClass("loading"),jq(checkboxes).each(function(e){jq(this).is(":checked")&&(checkboxes_tosend+=jq(this).attr("value")+",")}),""==checkboxes_tosend?(jq(this).removeClass("loading"),!1):(jq.post(ajaxurl,{action:"messages_delete",thread_ids:checkboxes_tosend},function(e){e[0]+e[1]=="-1"?jq("#message-threads").prepend(e.substr(2,e.length)):(jq("#message-threads").before('<div id="message" class="updated"><p>'+e+"</p></div>"),jq(checkboxes).each(function(e){jq(this).is(":checked")&&(jq(this).attr("checked",!1),jq(this).parent().parent().fadeOut(150))})),jq("#message").hide().slideDown(150),jq("#delete_inbox_messages, #delete_sentbox_messages").removeClass("loading")}),!1)):void 0}),jq("a#close-notice").click(function(){return jq(this).addClass("loading"),jq("div#sidebar div.error").remove(),jq.post(ajaxurl,{action:"messages_close_notice",notice_id:jq(".notice").attr("rel").substr(2,jq(".notice").attr("rel").length)},function(e){jq("a#close-notice").removeClass("loading"),e[0]+e[1]=="-1"?(jq(".notice").prepend(e.substr(2,e.length)),jq("div#sidebar div.error").hide().fadeIn(200)):jq(".notice").slideUp(100)}),!1}),jq("#wp-admin-bar ul.main-nav li, #nav li").mouseover(function(){jq(this).addClass("sfhover")}),jq("#wp-admin-bar ul.main-nav li, #nav li").mouseout(function(){jq(this).removeClass("sfhover")}),jq("a.logout").click(function(){jq.removeCookie("bp-activity-scope",{path:"/"}),jq.removeCookie("bp-activity-filter",{path:"/"}),jq.removeCookie("bp-activity-oldestpage",{path:"/"});var e=["members","groups","blogs","forums"];jq(e).each(function(t){jq.removeCookie("bp-"+e[t]+"-scope",{path:"/"}),jq.removeCookie("bp-"+e[t]+"-filter",{path:"/"}),jq.removeCookie("bp-"+e[t]+"-extras",{path:"/"})})})});